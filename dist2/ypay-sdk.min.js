!function(t){"use strict";class Currency{static USD="USD";static NGN="NGN";static XOF="F CFA";static isValid(t){return Object.values(this).includes(t.toUpperCase())}}const e=/^[A-Za-z0-9]{4}-[A-Za-z0-9]{4}$/,n=/^[0-9]{6}$/,a=/^[0-9]{1,}\|[A-Za-z0-9]{48}$/;class Transaction{constructor(t="",e="",n="",a=0,s="en",i={}){this.sender=this.sanitizeData(e),this.token=this.sanitizeData(t),this.otp=n,this.amount=parseFloat(a.toString()),this.language=s,this.paymentHandlers={onSuccess:i.onSuccess||(()=>{}),onFailure:i.onFailure||(()=>{})};const r=this._validate();r&&(this.validationError=r)}_validate(){const t=[];return this.sender?e.test(this.sender)||t.push("Sender card format is invalid."):t.push("Sender card is required."),this.token?a.test(this.token)||t.push("token card format is invalid."):t.push("token is required."),this.otp?n.test(this.otp)||t.push("Payment code format is invalid."):t.push("Payment code is required."),(isNaN(this.amount)||this.amount<=0)&&t.push("Amount must be a positive number."),["en","fr"].includes(this.language.toString().toLowerCase())||t.push("Language is invalid."),t.length>0?new Error(t.join("\n")):null}async exec(){if(this.validationError)throw this.paymentHandlers.onFailure(this.validationError),this.validationError;try{const t=await fetch("https://ypay.ytech-bf.com/api/v1/project/make-payment",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`,"accept-language":this.language},body:JSON.stringify({card_code:this.sender,amount:this.amount,payment_code:this.otp})});if(t.ok){const e=await t.json();return this.paymentHandlers.onSuccess(e),e}const e=(await t.json().catch(()=>({}))).message||t.statusText||"Payment failed";throw new Error(`${t.status}\n${e}`)}catch(t){throw this.paymentHandlers.onFailure(t),t}}isValid(){return!this.validationError}getValidationErrors(){return this.validationError?this.validationError.message:null}sanitizeData(t=""){return""===t||null==t?"":t=(t=(t=(t=String(t)).replace(/\\0/g,"")).trim()).replace(/<[^>]*>/g,"")}}class YPAY{constructor(t,e,n){this.token=t,this.currency=e||Currency.XOF,this.shopName=n||"Undefined";const a=this._validate();if(a&&(this.validationError=a),YPAY.instance)return YPAY.instance;YPAY.instance=this}createTransaction(t,e,n,a,s={}){return new Transaction(this.token,t,e,n,a,s).exec()}static resetInstance(){YPAY.instance=null}_validate(){const t=[];return Currency.isValid(this.currency)||t.push(this.currency+" is not supported yet"),t.length>0?new Error(t.join("\n")):null}}"undefined"!=typeof module&&module.exports&&(module.exports={YPAY:YPAY,Transaction:Transaction,Currency:Currency,cardPattern:e,paymentCodePattern:n,tokenPattern:a}),t.YPAY=YPAY,t.YPAYTransaction=Transaction,t.YPAYCurrency=Currency}("undefined"!=typeof window?window:this);